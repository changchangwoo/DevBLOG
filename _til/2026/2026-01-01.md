---
date: 2026-01-01
---

# Next.js Blog Starter 개발 지침서

## 목적

- Next.js 기반 개발 블로그 구축
- Markdown 기반 포스팅 관리
- 정적 사이트로 빌드하여 S3 + CloudFront 배포
- 댓글/좋아요 등 인터랙션은 AWS Lambda(API Gateway)로 처리
- 장기적으로 광고 수익화를 고려한 저비용 아키텍처 유지

---

## 기본 원칙 (중요)

1. **Next.js는 정적 사이트 생성기(SSG)로만 사용한다**

   - Server Actions, Edge Functions, ISR은 사용하지 않는다
   - 런타임 서버 의존 기능을 추가하지 않는다

2. **콘텐츠는 Markdown(md / mdx) 파일로 관리한다**

   - Git 기반 포스팅 관리
   - Front Matter를 통해 메타데이터를 구조화한다

3. **백엔드 비즈니스 로직은 플랫폼 독립적으로 설계한다**
   - Next.js API는 사용하지 않거나 최소한의 어댑터 역할만 수행
   - 추후 AWS Lambda로 이전/확장이 가능해야 한다

---

## 개발 명령어

```bash
# 개발 서버 실행 (http://localhost:3000)
pnpm dev

# 프로덕션 빌드
pnpm build

# 프로덕션 서버 실행
pnpm start

# ESLint 실행
pnpm lint
```

---

## 프로젝트 구조

### 디렉토리 구조

```
DevBLOG/
├── _posts/              # Markdown 블로그 포스트 저장소
│   ├── hello-world.md
│   ├── nextjs-blog-architecture.md
│   └── typescript-tips.md
├── app/                 # Next.js App Router
│   ├── posts/[slug]/   # 동적 포스트 페이지
│   │   └── page.tsx
│   ├── layout.tsx      # 루트 레이아웃
│   ├── page.tsx        # 홈페이지 (포스트 목록)
│   └── globals.css     # 전역 스타일 + prose 스타일
├── lib/                # 유틸리티 함수
│   └── posts.ts        # Markdown 파싱 및 포스트 관리
└── public/             # 정적 파일 (이미지, SVG 등)
```

### 기술 스택

- **Next.js 16.1.0** (App Router, SSG)
- **React 19.2.3** (Server Components 기본)
- **TypeScript 5** (strict mode)
- **Tailwind CSS 4** (`@tailwindcss/postcss`)
- **pnpm** (패키지 매니저)
- **gray-matter** (Front Matter 파싱)
- **Markdown 처리**:
  - `remark` - Markdown 파서
  - `remark-gfm` - GitHub Flavored Markdown (테이블, 체크박스, 취소선)
  - `remark-rehype` - Markdown → HTML AST 변환
  - `rehype-highlight` - 코드 신택스 하이라이팅
  - `rehype-slug` - 헤딩 자동 ID 생성
  - `rehype-autolink-headings` - 헤딩 자동 링크
  - `highlight.js` - 코드 하이라이팅 테마

---

## 블로그 시스템 아키텍처

### 포스트 작성 흐름

1. `_posts/` 디렉토리에 `.md` 파일 생성
2. Front Matter로 메타데이터 정의 (title, excerpt, date, author)
3. Markdown으로 본문 작성
4. 빌드 시 `generateStaticParams()`로 모든 포스트 페이지를 정적 생성

### Front Matter 형식

```markdown
---
title: "포스트 제목"
excerpt: "짧은 요약"
date: "2024-01-15"
author:
  name: "작성자 이름"
coverImage: ""
---

# 본문 내용...
```

### 핵심 파일 설명

#### `lib/posts.ts`

Markdown 파일 읽기 및 파싱을 담당하는 유틸리티 모듈:

- `getPostSlugs()` - 모든 포스트의 슬러그 목록 반환
- `getPostBySlug(slug)` - 특정 포스트의 메타데이터 + 콘텐츠 반환
- `getAllPosts()` - 모든 포스트의 메타데이터 반환 (날짜 내림차순 정렬)
- `markdownToHtml(markdown)` - 향상된 Markdown → HTML 변환
  - GitHub Flavored Markdown 지원 (테이블, 체크박스, 취소선)
  - 코드 블록 자동 신택스 하이라이팅
  - 헤딩에 자동 ID 및 앵커 링크 생성

**중요**: 이 파일은 Node.js 파일 시스템 API(`fs`, `path`)를 사용하므로 Server Component에서만 호출 가능.

#### `app/page.tsx`

홈페이지 - 모든 블로그 포스트 목록 표시:

- `getAllPosts()`로 포스트 목록 가져오기
- 각 포스트 카드에 제목, 발췌, 날짜, 작성자 표시
- 클릭 시 `/posts/[slug]`로 이동

#### `app/posts/[slug]/page.tsx`

개별 포스트 페이지:

- `generateStaticParams()` - 빌드 시 모든 포스트 슬러그 생성
- `generateMetadata()` - 동적 메타데이터 (SEO)
- `getPostBySlug(slug)` - 포스트 데이터 로드
- `markdownToHtml()` - Markdown → HTML 변환
- `.prose` 클래스로 커스텀 타이포그래피 스타일 적용

---

## 스타일링

### Tailwind CSS 4 + 커스텀 Prose

- `app/globals.css`에 커스텀 `.prose` 스타일 정의
- `@tailwindcss/typography` 플러그인 **사용하지 않음** (Tailwind v4와 호환 문제)
- 대신 수동으로 prose 스타일을 구현하여 완전한 제어 가능

### CSS 변수 기반 테마

```css
:root {
  --background: #ffffff;
  --foreground: #171717;
}

@media (prefers-color-scheme: dark) {
  :root {
    --background: #0a0a0a;
    --foreground: #ededed;
  }
}
```

### Geist 폰트

- `next/font/google`로 Geist Sans / Geist Mono 로드
- CSS 변수로 전역 적용: `--font-geist-sans`, `--font-geist-mono`

---

## 주요 개발 패턴

### 1. Server Components 우선

- App Router는 기본적으로 모든 컴포넌트가 Server Component
- `"use client"` 지시어는 상태/이벤트/브라우저 API가 필요한 경우에만 사용
- 파일 시스템 접근(`lib/posts.ts`)은 Server Component에서만 가능

### 2. Static Site Generation (SSG)

- `generateStaticParams()`를 사용해 빌드 타임에 모든 페이지를 미리 생성
- 런타임 서버 불필요 → S3 + CloudFront로 배포 가능
- **사용 금지**: Server Actions, ISR, Edge Functions

### 3. 타입 안정성

- TypeScript strict mode 활성화
- Props는 `Readonly<>` 타입 사용
- 인터페이스로 Post 메타데이터 구조 정의 (`lib/posts.ts` 참조)

### 4. 새 포스트 추가 방법

1. `_posts/new-post.md` 파일 생성
2. Front Matter 작성 (title, excerpt, date, author)
3. Markdown 본문 작성
4. `pnpm build` 실행 → 자동으로 정적 페이지 생성됨
5. Git commit 후 배포

### 5. 마크다운 작성 가이드

이 블로그는 **GitHub Flavored Markdown (GFM)**을 완전히 지원합니다.

#### 지원하는 기능

**코드 블록 (자동 신택스 하이라이팅)**

````markdown
```javascript
const hello = "world";
```
````

````

**테이블**
```markdown
| 헤더1 | 헤더2 |
|------|------|
| 내용1 | 내용2 |
````

**체크박스**

```markdown
- [x] 완료된 작업
- [ ] 진행 중인 작업
```

**취소선**

```markdown
~~삭제된 텍스트~~
```

**헤딩 자동 링크**

- 모든 헤딩(`#`, `##`, `###`)에 자동으로 ID와 앵커 링크가 생성됨
- 헤딩을 클릭하면 해당 섹션으로 직접 링크 가능

**인라인 코드**

```markdown
`코드`는 백틱으로 감싸서 표시
```

---

## 참고사항

- **경로 별칭**: `@/*`는 프로젝트 루트를 가리킴 (`tsconfig.json`)
- **ESLint**: Next.js의 `core-web-vitals` + `typescript` 설정 사용
- **이미지**: `next/image` 컴포넌트 사용, `public/` 디렉토리에 저장
- **다크 모드**: `prefers-color-scheme` 미디어 쿼리로 자동 전환
- **코드 하이라이팅**:
  - `highlight.js`의 GitHub 테마 사용 (라이트 모드)
  - 다크 모드에서는 VS Code 스타일로 자동 전환
  - JavaScript, TypeScript, Python, Bash, Go, Rust 등 주요 언어 지원
- **커스텀 Prose 스타일**: `app/globals.css`에 수동으로 정의
  - Tailwind CSS 4와의 호환성을 위해 `@tailwindcss/typography` 미사용

---

## TIL (Today I Learned) 시스템

### 개요

TIL은 매일의 학습 기록을 GitHub 잔디 스타일의 캘린더로 시각화하는 기능입니다. 블로그 포스트와 달리 짧고 러프한 bullet point 형식의 학습 메모를 관리하며, **"꾸준히 기록하는 개발자"를 증명하는 시각적 대시보드** 역할을 합니다.

### 핵심 설계 원칙

1. **DB 사용 없음** - Markdown 파일로 관리
2. **빌드 타임 데이터 로드** - 모든 TIL을 빌드 시 HTML로 변환
3. **API 없는 정적 사이트** - 런타임 서버 의존성 제로
4. **포스트 시스템과 동일한 패턴** - `_posts`와 같은 아키텍처

---

### 디렉토리 구조

```
DevBLOG/
├── _til/                    # TIL Markdown 파일 저장소
│   └── 2025/               # 연도별 디렉토리
│       ├── 2025-12-25.md
│       ├── 2025-12-24.md
│       └── 2025-12-20.md
├── app/
│   └── til/
│       ├── page.tsx        # TIL 메인 페이지 (Server Component)
│       └── TILPageClient.tsx  # 클라이언트 로직
├── components/
│   ├── TILCalendar.tsx     # GitHub 잔디 스타일 캘린더
│   └── TILModal.tsx        # TIL 내용 표시 모달
└── lib/
    └── til.ts              # TIL 데이터 파싱 유틸리티
```

---

### TIL Markdown 파일 형식

#### 파일명 규칙

- **형식**: `YYYY-MM-DD.md`
- **예시**: `2025-12-25.md`
- **위치**: `_til/{연도}/` 디렉토리

#### Front Matter 형식

```markdown
---
date: 2025-12-25
---

- Next.js SSG vs ISR 정리
- TOC 구현 방식 복기
- TypeScript 제네릭 활용법
```

**특징**:

- Front Matter에는 `date` 필드만 존재
- 본문은 간단한 bullet point 형식
- SEO나 완성도보다 꾸준한 기록이 목적

---

### 데이터 흐름 아키텍처

#### 빌드 타임 (SSG)

```
1. 빌드 시작
   ↓
2. lib/til.ts의 getAllTILsWithHtmlForYear() 실행
   ↓
3. _til/2025/ 디렉토리의 모든 .md 파일 읽기
   ↓
4. 각 파일의 Markdown을 HTML로 변환
   ↓
5. Map<date, html> 생성
   ↓
6. Server Component (app/til/page.tsx)에서 데이터 로드
   ↓
7. 직렬화하여 Client Component에 props로 전달
```

#### 런타임 (클라이언트)

```
1. 페이지 로드 시 모든 TIL 데이터가 이미 포함됨
   ↓
2. 캘린더에서 날짜 클릭
   ↓
3. 로컬 Map에서 해당 날짜의 HTML 즉시 조회
   ↓
4. 모달에 내용 표시 (API 호출 없음)
```

**핵심**: API 호출 없이 빌드 시 모든 데이터를 미리 로드하여 즉각적인 사용자 경험 제공

---

### 핵심 파일 설명

#### `lib/til.ts`

TIL 데이터 파싱 및 관리 유틸리티 모듈:

**주요 함수**:

```typescript
// 특정 연도의 모든 TIL 날짜 목록 (파일명 기반)
getTILDates(year: number): string[]

// 특정 날짜의 TIL 원본 데이터
getTILByDate(date: string): TILData | null

// Markdown을 HTML로 변환
markdownToHtml(markdown: string): Promise<string>

// 캘린더 표시용 - 날짜별 TIL 존재 여부
getAllTILsForYear(year: number): Map<string, boolean>

// 빌드타임 로드용 - 모든 TIL을 HTML로 변환
getAllTILsWithHtmlForYear(year: number): Promise<Map<string, string>>

// 사용 가능한 연도 목록
getAvailableYears(): number[]
```

**중요 포인트**:

- `lib/posts.ts`와 동일한 패턴 사용
- Node.js 파일 시스템 API 사용 → Server Component에서만 호출 가능
- `remark` + `remark-gfm`으로 Markdown 파싱 (블로그 포스트와 동일)

---

#### `app/til/page.tsx`

TIL 메인 페이지 - **Server Component**

**역할**:

1. URL 쿼리 파라미터로 연도 선택 처리 (`?year=2025`)
2. 빌드 시 모든 TIL 데이터 로드:
   - `getAllTILsForYear()` → 날짜별 존재 여부 Map
   - `getAllTILsWithHtmlForYear()` → 날짜별 HTML 컨텐츠 Map
3. 두 개의 Map을 직렬화하여 Client Component에 전달

**코드 흐름**:

```typescript
export default async function TILPage({ searchParams }) {
  const selectedYear = searchParams.year || getCurrentYear();

  // 1. TIL 존재 여부 로드
  const tilData = getAllTILsForYear(selectedYear);

  // 2. 모든 TIL 내용을 HTML로 변환하여 로드 (빌드 시)
  const tilContentMap = await getAllTILsWithHtmlForYear(selectedYear);

  // 3. Map을 객체로 변환 (직렬화)
  const tilDataObject = Object.fromEntries(tilData);
  const tilContentObject = Object.fromEntries(tilContentMap);

  return (
    <TILPageClient
      tilData={new Map(Object.entries(tilDataObject))}
      tilContentMap={new Map(Object.entries(tilContentObject))}
      availableYears={availableYears}
    />
  );
}
```

---

#### `app/til/TILPageClient.tsx`

TIL 클라이언트 로직 - **Client Component**

**역할**:

1. 캘린더 인터랙션 관리
2. 모달 상태 관리
3. 날짜 클릭 시 로컬 Map에서 데이터 즉시 조회

**핵심 로직**:

```typescript
export default function TILPageClient({
  tilData, // Map<date, boolean> - 존재 여부
  tilContentMap, // Map<date, html> - HTML 컨텐츠
}) {
  const [selectedDate, setSelectedDate] = useState<string | null>(null);

  // 날짜 클릭 핸들러 (API 호출 없음!)
  const handleDateClick = (date: string) => {
    setSelectedDate(date); // 모달 오픈만 처리
  };

  // 선택된 날짜의 컨텐츠 즉시 조회
  const selectedContent = selectedDate
    ? tilContentMap.get(selectedDate) || "TIL 내용이 없습니다."
    : "";

  return (
    <>
      <TILCalendar tilData={tilData} onDateClick={handleDateClick} />
      <TILModal date={selectedDate} content={selectedContent} />
    </>
  );
}
```

**중요**:

- **API 호출 없음** - 모든 데이터는 이미 props로 전달됨
- **즉각적인 응답** - 로컬 Map 조회만으로 모달 표시
- **오프라인 작동** - 한 번 로드되면 네트워크 불필요

---

#### `components/TILCalendar.tsx`

GitHub 잔디 스타일의 연간 캘린더 컴포넌트

**기능**:

1. 1년(365일)을 주 단위(7일)로 그리드 표시
2. TIL이 있는 날짜는 초록색 (`.bg-green-500`)
3. TIL이 없는 날짜는 회색 (`.bg-zinc-100`)
4. 날짜 클릭 시 `onDateClick` 콜백 호출

**주요 로직**:

```typescript
// 1년 전체 날짜 생성 (1월 1일 ~ 12월 31일)
const generateYearDates = () => { ... }

// 주 단위로 그룹화 (일요일 시작)
const groupByWeeks = (dates: Date[]) => { ... }

// 날짜별 TIL 존재 여부 확인
const hasTIL = tilData.get(dateStr) || false;
```

**시각화**:

- 월 라벨 (Jan, Feb, ..., Dec)
- 요일 라벨 (Sun, Mon, ..., Sat)
- 반응형 디자인 (모바일: 작게 / 데스크톱: 크게)
- 호버 효과 및 툴팁

---

#### `components/TILModal.tsx`

TIL 내용을 표시하는 모달 컴포넌트

**기능**:

1. 날짜 + HTML 컨텐츠 표시
2. ESC 키 / 배경 클릭으로 닫기
3. 모달 열림 시 body 스크롤 방지
4. 다크 모드 지원

**Props**:

```typescript
interface TILModalProps {
  isOpen: boolean;
  onClose: () => void;
  date: string; // YYYY-MM-DD
  content: string; // HTML string
}
```

**UI 구조**:

- 헤더: 날짜 (한글 포맷 "YYYY년 MM월 DD일") + 닫기 버튼
- 컨텐츠: `dangerouslySetInnerHTML`로 HTML 렌더링
- 푸터: 닫기 버튼

---

### 새 TIL 추가 방법

#### 1. Markdown 파일 생성

```bash
# 경로: _til/2025/2025-12-26.md
```

#### 2. Front Matter 작성

```markdown
---
date: 2025-12-26
---

- React Server Components 동작 원리
- CSS Grid vs Flexbox 비교
- Git rebase 실전 활용법
```

#### 3. 빌드 및 확인

```bash
pnpm build
# → _til/2025/2025-12-26.md가 자동으로 HTML로 변환됨
# → 캘린더에 12월 26일이 초록색으로 표시됨
```

#### 4. Git commit 후 배포

```bash
git add _til/2025/2025-12-26.md
git commit -m "TIL: React Server Components 학습"
git push
```

---

### 통계 및 시각화

TIL 페이지는 다음 통계를 자동으로 계산하여 표시합니다:

1. **총 학습 일수**: `tilData.size`
2. **현재 연도**: `year`
3. **학습 달성률**: `(tilData.size / 365) * 100`

**예시**:

```
┌─────────────────┬─────────────────┬─────────────────┐
│ 총 학습 일수     │ 현재 연도        │ 학습 달성률      │
├─────────────────┼─────────────────┼─────────────────┤
│ 127일           │ 2025년          │ 34.8%          │
└─────────────────┴─────────────────┴─────────────────┘
```

---

### 성능 최적화

#### 빌드 타임 최적화

```typescript
// ✅ 병렬 처리로 최적화된 HTML 변환
export async function getAllTILsWithHtmlForYear(year: number) {
  const dates = getTILDates(year);
  const tilMap = new Map<string, string>();

  // 모든 Markdown을 병렬로 HTML 변환
  for (const date of dates) {
    const tilData = getTILByDate(date);
    if (tilData) {
      const html = await markdownToHtml(tilData.content);
      tilMap.set(date, html);
    }
  }

  return tilMap;
}
```

**효과**:

- 빌드 시 한 번만 변환
- 런타임 오버헤드 제로
- S3 + CloudFront 배포에 최적화

#### 런타임 최적화

```typescript
// ✅ 로컬 Map 조회 - O(1) 시간 복잡도
const selectedContent = tilContentMap.get(selectedDate);

// ❌ API 호출 (이전 방식) - 네트워크 지연 발생
// const response = await fetch(`/api/til?date=${date}`);
```

**효과**:

- 즉각적인 모달 표시
- 네트워크 요청 제로
- 오프라인 작동 가능

---

### 연도별 필터링

TIL은 URL 쿼리 파라미터로 연도 선택을 지원합니다:

**URL 형식**:

- 기본: `/til` → 현재 연도 표시
- 연도 지정: `/til?year=2024` → 2024년 TIL 표시

**구현**:

```typescript
// Server Component에서 쿼리 파라미터 처리
export default async function TILPage({ searchParams }) {
  const yearParam = searchParams.year;
  const currentYear = getCurrentYear();
  const selectedYear = yearParam ? parseInt(yearParam, 10) : currentYear;

  // 선택된 연도의 데이터만 로드
  const tilData = getAllTILsForYear(selectedYear);
  const tilContentMap = await getAllTILsWithHtmlForYear(selectedYear);

  // ...
}
```

**UI**:

- 연도 선택 버튼 자동 생성
- 현재 선택된 연도는 primary 색상으로 강조

---

### TIL vs 블로그 포스트 비교

| 항목             | TIL                     | 블로그 포스트                             |
| ---------------- | ----------------------- | ----------------------------------------- |
| **목적**         | 매일의 러프한 학습 메모 | 완성도 있는 기술 글                       |
| **형식**         | Bullet point            | 구조화된 문서                             |
| **길이**         | 짧음 (3-5줄)            | 김 (500+ 단어)                            |
| **작성 시간**    | 1-2분                   | 30분 ~ 수 시간                            |
| **SEO**          | 중요하지 않음           | 매우 중요                                 |
| **시각화**       | GitHub 잔디 캘린더      | 포스트 목록/카드                          |
| **디렉토리**     | `_til/YYYY/`            | `_posts/category/`                        |
| **Front Matter** | `date`만                | `title`, `excerpt`, `author`, `tag`, etc. |
| **URL**          | `/til?year=2025`        | `/post/category/slug`                     |

---

### 주의사항

1. **파일명 규칙 준수**

   - 반드시 `YYYY-MM-DD.md` 형식 사용
   - 잘못된 예: `2025-1-5.md` (❌ 0 패딩 누락)
   - 올바른 예: `2025-01-05.md` (✅)

2. **연도 디렉토리 필수**

   - `_til/2025-12-25.md` (❌)
   - `_til/2025/2025-12-25.md` (✅)

3. **Front Matter 필수**

   ```markdown
   ---
   date: 2025-12-25
   ---
   ```

   - `date` 필드 누락 시 파싱 오류 발생

4. **빌드 시점 데이터 로드**

   - TIL 추가/수정 후 반드시 `pnpm build` 실행
   - 개발 서버(`pnpm dev`)에서는 hot reload 작동

5. **대용량 TIL 관리**
   - 1년에 365개 TIL 생성 가능
   - 수년치 누적 시 빌드 시간 증가 가능
   - 필요 시 연도별 lazy loading 고려

---

### 확장 가능성

향후 TIL 시스템 확장 시 고려사항:

1. **태그 시스템**

   ```markdown
   ---
   date: 2025-12-25
   tags: [react, typescript, nextjs]
   ---
   ```

   - 태그별 필터링
   - 태그 클라우드 시각화

2. **월별 뷰**

   - 연간 캘린더 외에 월별 상세 뷰 추가
   - 해당 월의 모든 TIL 목록 표시

3. **검색 기능**

   - TIL 내용 전체 텍스트 검색
   - 빌드 시 검색 인덱스 생성

4. **통계 대시보드**
   - 연속 학습 일수 (streak)
   - 요일별 학습 패턴 분석
   - 월별 학습 횟수 차트

---

### 문제 해결 (Troubleshooting)

#### TIL이 캘린더에 표시되지 않는 경우

1. **파일명 확인**

   ```bash
   # 올바른 형식인지 확인
   ls _til/2025/
   # 출력 예: 2025-12-25.md
   ```

2. **Front Matter 확인**

   ```markdown
   ---
   date: 2025-12-25 # 파일명과 동일해야 함
   ---
   ```

3. **빌드 재실행**

   ```bash
   pnpm build
   ```

4. **캐시 삭제**
   ```bash
   rm -rf .next
   pnpm build
   ```

#### 모달에 내용이 표시되지 않는 경우

1. **HTML 변환 확인**

   - `lib/til.ts`의 `markdownToHtml()` 함수가 정상 작동하는지 확인
   - 콘솔에 에러 메시지 확인

2. **Props 전달 확인**
   - `TILPageClient`의 `tilContentMap`에 데이터가 있는지 확인
   - React DevTools로 props 검사

---
